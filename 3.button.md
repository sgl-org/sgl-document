## 1. 简介

`Button`（按钮）是图形用户界面中最基础且高频使用的交互控件。  
在 **SGL（Simple Graphics Library）** 中，按钮支持文本、图标、背景图片、圆角、边框、透明度等多种样式，并具备按下时的视觉反馈。

> ⚠️ 按钮是**终端控件**，不能包含子控件。~~不能作为父~~

---

## 2. 创建按钮

使用 `sgl_button_create()` 创建按钮：

```c
sgl_obj_t* button = sgl_button_create(parent);
```

- `parent`：父对象（可为 `NULL`，表示顶层控件）

---

## 3. 常用属性设置

### 3.1 位置与尺寸

```c
sgl_obj_set_pos(button, x, y);           // 设置位置
sgl_obj_set_size(button, width, height); // 设置宽高
```

### 3.2 文本样式

```c
sgl_button_set_text(button, "BUTTON");               // 设置文本
sgl_button_set_font(button, &consolas23);         // 设置字体
sgl_button_set_text_color(button, SGL_COLOR_WHITE); // 文本颜色
sgl_button_set_text_align(button, SGL_ALIGN_CENTER); // 对齐方式
```

### 3.3 背景与透明度

```c
sgl_button_set_color(button, SGL_COLOR_BLUE); // 背景颜色
sgl_button_set_alpha(button, 200);            // 透明度 (0~255)
```

### 3.4 边框与圆角

```c
sgl_button_set_border_width(button, 2);       // 边框宽度
sgl_button_set_border_color(button, SGL_COLOR_BLACK); // 边框颜色
sgl_button_set_radius(button, 10);            // 圆角半径
```

### 3.5 图标与背景图

```c
sgl_button_set_icon(button, &icon_pixmap);    // 设置图标（前景）
sgl_button_set_pixmap(button, &bg_pixmap);    // 设置背景图片
```

> 📌 图标和背景图需提前定义为 `sgl_pixmap_t` 类型的全局常量。

---

## 3. 事件处理机制

### 3.1 支持的事件类型

| 事件 | 说明 |
|------|------|
| [`SGL_EVENT_PRESSED`](file://f:\Users\22279\Desktop\sgl-vscode-v1.0\sgl-vscode-debug-test\sgl-vscode-debug-test\sgl\source\include\sgl_event.h#L51) | 用户按下按钮 |
| [`SGL_EVENT_RELEASED`](file://f:\Users\22279\Desktop\sgl-vscode-v1.0\sgl-vscode-debug-test\sgl-vscode-debug-test\sgl\source\include\sgl_event.h#L52) | 用户释放按钮（完成一次点击）|

> ✅ 推荐在 `SGL_EVENT_RELEASED` 中执行业务逻辑，避免误触发。

### 3.2 注册事件回调

```c
sgl_obj_set_event_cb(button, event_handler, user_data);
sgl_obj_set_clickable(button); // 启用点击功能（SGL默认可点击）
```

> 🔒 若需**禁用按钮**，可调用：  
> `sgl_obj_set_unclickable(button);`

### 3.3 程序化触发事件

使用 [`sgl_event_send_obj()`](file://f:\Users\22279\Desktop\sgl-vscode-v1.0\sgl-vscode-debug-test\sgl-vscode-debug-test\sgl\source\include\sgl_event.h#L223) 可主动模拟用户操作：**%% (适用于外部按键触发) %%**

```c
sgl_event_send_obj(button, SGL_EVENT_PRESSED);
sgl_event_send_obj(button, SGL_EVENT_RELEASED);
```

#### 典型应用场景：
- 键盘快捷键映射到按钮功能
- 定时器或状态机触发操作

> 💡 此函数会**立即调用事件回调**，不要将这两条函数连续的使用，中间须用延时或通过判断按键的状态来分别调用，这样按键被点击的那个放大效果才能正常被看到。

---

## 4. 应用示例

```c
#include <sgl.h>
#include <sgl_font.h>

static int click_count = 0;

static void on_button_event(sgl_event_t* event) {
    switch (event->type) {
        case SGL_EVENT_PRESSED:
            printf("按钮被按下\n");
            break;
        case SGL_EVENT_RELEASED:
            click_count++;
            printf("按钮点击次数: %d\n", click_count);
            break;
    }
}

static void simulate_click(sgl_obj_t* btn) {
    sgl_event_send_obj(btn, SGL_EVENT_PRESSED);
    sgl_event_send_obj(btn, SGL_EVENT_RELEASED);
}

int main(void) {
    sgl_init();
    sgl_obj_t* page = sgl_obj_create(NULL);
    sgl_screen_load(page);

    // 容器
    sgl_obj_t* container = sgl_rect_create(page);
    sgl_obj_set_pos(container, 20, 20);
    sgl_obj_set_size(container, 400, 250);
    sgl_rect_set_color(container, SGL_COLOR_LIGHT_GRAY);

    // 示例按钮
    sgl_obj_t* btn1 = sgl_button_create(container);
    sgl_obj_set_pos(btn1, 20, 20);
    sgl_obj_set_size(btn1, 120, 40);
    sgl_button_set_text(btn1, "圆角按钮");
    sgl_button_set_color(btn1, SGL_COLOR_GREEN);
    sgl_button_set_text_color(btn1, SGL_COLOR_WHITE);
    sgl_button_set_radius(btn1, 10);
    sgl_obj_set_event_cb(btn1, on_button_event, NULL);
    sgl_obj_set_clickable(btn1);

    // 自动触发按钮
    sgl_obj_t* auto_btn = sgl_button_create(container);
    sgl_obj_set_pos(auto_btn, 20, 80);
    sgl_obj_set_size(auto_btn, 150, 40);
    sgl_button_set_text(auto_btn, "自动点击");
    sgl_button_set_color(auto_btn, SGL_COLOR_ORANGE);
    sgl_obj_set_event_cb(auto_btn, on_button_event, NULL);
    sgl_obj_set_clickable(auto_btn);

    // 显示计数的标签
    sgl_obj_t* label = sgl_label_create(container);
    sgl_obj_set_pos(label, 20, 140);
    sgl_obj_set_size(label, 300, 30);
    sgl_label_set_font(label, &consolas23);
    sgl_label_set_text_color(label, SGL_COLOR_BLACK);

    // 模拟点击
    simulate_click(auto_btn);

    while (1) {
        char buf[64];
        sprintf(buf, "总点击次数: %d", click_count);
        sgl_label_set_text(label, buf);
        sgl_task_handle(); // 必须调用以处理事件
    }

    return 0;
}
```

---

## 5. 高级样式

```c
sgl_obj_t* custom_btn = sgl_button_create(parent);
sgl_obj_set_pos(custom_btn, 50, 50);
sgl_obj_set_size(custom_btn, 150, 50);

// 图标 + 文本组合
sgl_button_set_icon(custom_btn, &icon_home);
sgl_button_set_text(custom_btn, "主页");
sgl_button_set_font(custom_btn, &consolas23);
sgl_button_set_text_color(custom_btn, SGL_COLOR_WHITE);

// 圆角 + 边框
sgl_button_set_radius(custom_btn, 15);
sgl_button_set_border_width(custom_btn, 2);
sgl_button_set_border_color(custom_btn, SGL_COLOR_GOLD);

// 背景（可选 pixmap 实现渐变）
// sgl_button_set_pixmap(custom_btn, &btn_bg_gradient);

sgl_obj_set_event_cb(custom_btn, on_button_event, NULL);
sgl_obj_set_clickable(custom_btn);
```

---


---

> 📘 相关头文件路径：  
> - 按钮 API：`sgl/source/widgets/button/sgl_button.h`  
> - 事件系统：`sgl/source/include/sgl_event.h`  
> - 核心对象：`sgl/source/include/sgl_core.h`

---

